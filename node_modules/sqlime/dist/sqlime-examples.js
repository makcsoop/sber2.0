(()=>{function u(i){if(i===null)return"(empty)";let[e,n]=[i.columns,i.values],t="<thead>"+o(e,"th")+"</thead>",s=n.map(function(a){return o(a.map(b),"td")});return t+="<tbody>"+o(s,"tr")+"</tbody>",`<table>${t}</table>`}function m(i){let e="<thead><tr><th>table</th></tr></thead>",n=i.map(function(t){return`<tr>
            <td>
                <button class="sqlime-link" data-action="showTable" data-arg="${t}">
                    ${t}
                </button>
            </td>
        </tr>`});return e+="<tbody>"+n.join(`
`)+"</tbody>",`<table>${e}</table>`}function h(i){return`<pre>${i}</pre>`}function o(i,e){if(i.length===0)return"";let n="<"+e+">",t="</"+e+">";return n+i.join(t+n)+t}function b(i){let e=document.createElement("div");return e.innerText=i,e.innerHTML}var p={printMarkdown:h,printResult:u,printTables:m},c=p;var l=class extends HTMLElement{fadeOut(){this.style.opacity=.4}fadeIn(){setTimeout(()=>{this.style.opacity=""},100)}showResult(e){this.style.display="block",this.innerHTML=c.printResult(e)}showMessage(e){this.style.display="block",this.innerHTML=e}},r=class extends HTMLElement{constructor(){super(),this.database=null,this.examples=[]}connectedCallback(){this.rendered||(this.render(),this.listen(),this.rendered=!0)}render(){let e=this.getAttribute("selector")||"pre",n=this.hasAttribute("editable");document.querySelectorAll(e).forEach(t=>{let s=this.init(t);n&&this.makeEditable(t,s)})}listen(){document.addEventListener("sqlime-ready",e=>{let n=this.getAttribute("db");e.detail.name==n&&(this.database=e.detail.database)})}init(e){let n=document.createElement("sqlime-output");n.style.display="none";let t=document.createElement("button");t.innerHTML="Run",t.addEventListener("click",f=>{this.execute(e.innerText,n)});let s=document.createElement("div");s.appendChild(t);let a=document.createElement("div");a.className="sqlime-example",a.appendChild(s),a.appendChild(n),e.insertAdjacentElement("afterend",a);let d={commandsEl:s,outputEl:n};return this.examples.push(d),d}makeEditable(e,n){e.contentEditable="true",e.addEventListener("keydown",s=>!s.ctrlKey&&!s.metaKey?!0:s.keyCode==10||s.keyCode==13?(this.execute(e.innerText,n.outputEl),!1):!0);let t=document.createElement("a");t.innerHTML="Edit",t.style.cursor="pointer",t.style.display="inline-block",t.style.marginLeft="1em",n.commandsEl.appendChild(t),t.addEventListener("click",s=>(e.focus(),!1))}execute(e,n){if(e=e.trim(),!e){n.showMessage("");return}try{n.fadeOut();let t=this.getDatabase().execute(e);n.showResult(t)}catch(t){n.showMessage(t)}finally{n.fadeIn()}}getDatabase(){return this.database==null&&(this.database=this.loadDatabase()),this.database}loadDatabase(){if(!("Sqlime"in window)||!("db"in window.Sqlime))throw new Error("Sqlime is not initialized. Use the 'sqlime-db' component to initialize it.");let e=this.getAttribute("db");if(!e)throw new Error("Missing the 'db' attribute.");if(!(e in window.Sqlime.db))throw new Error(`Database '${e}' is not loaded. Use the 'sqlime-db' component to load it.`);return window.Sqlime.db[e]}};window.customElements.get("sqlime-examples")||(window.SqlimeExamples=r,customElements.define("sqlime-examples",r),customElements.define("sqlime-output",l));})();
